#include <stdint.h>
#include <stm32f405xx.h>
#include <stdio.h>
#include "lcd.h"  // Include your LCD header file

void SPI1_master_config(void);
void SPI1GPIO_init(void);
void SPI_slave(void);

uint32_t result = 0;
char buffer[30];  // For displaying on LCD



void SPI1_master_config(void)
{
	RCC->APB2ENR |=(1<<12); //SPI Enble PG 266
	SPI1->CR1 |=(1<<2);
	SPI1->CR1 |=((1<<0)|(1<<1));
	//sets f/16
	SPI1->CR1 |=(1<<3);
	SPI1->CR1 |=(1<<4);
	SPI1->CR1 &=~(1<<5);
	SPI1->CR1 &=~(1<<7);


	SPI1->CR1 |=(1<<8);
	SPI1->CR1 |=(1<<9);
	SPI1->CR1 &=~((1<<10)|(1<<11)|(1<<12)|(1<<13));
	SPI1->CR1 &=~(1<<15);
	SPI1->CR1 |=(1<<6);
}

void SPI_slave(void)
{
RCC->APB1ENR |=(1<<14);// enable clock
SPI2->CR1 &=~(1<<2);
SPI2->CR1 |=((1<<0)|(1<<1));
SPI2->CR1 &=~(1<<7);//BIT as 0
SPI2->CR1 &=~(1<<8);//BIT as 0
SPI2->CR1 |=(1<<9);
SPI2->CR1 &=~(1<<10);//BIT as 0
SPI2->CR1 &=~(1<<11);//BIT as 0
SPI2->CR1 &=~(1<<12);//BIT as 0
SPI2->CR1 &=~(1<<13);//BIT as 0
SPI2->CR1 &=~(1<<15);//BIT as 0

SPI2->CR1 |=(1<<6);
}
int main(void)
{
    SPI1GPIO_init();
    SPI1_master_config();
    SPI_slave();

    lcd_gpio_init();  // Initialize LCD GPIO
    lcd_init();       // Initialize LCD

    lcd_gpio_init();
    lcd_init();

    lcd(0x80, 0);
    lcd_string("Hello LCD!");
    while(1);

}
